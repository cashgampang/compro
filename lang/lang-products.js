const translations = {
  en: {
    products: {
      // Banner Section
      banner_title: "Products",
      banner_text: "Explore the wonders we have created",

      // Product Showcase Section
      showcase_product1_title: "Fat Filled Whey Powder",
      showcase_product1_feature1: "Rich in natural vitamins and minerals",
      showcase_product1_feature2: "Suitable for children and adults",
      showcase_product1_feature3: "100% natural with no artificial additives",
      showcase_product1_feature4: "Guaranteed fresh delivery every day",
      showcase_product2_title: "Full Cream Milk Powder",
      showcase_product2_feature1: "Low fat content for health-conscious families",
      showcase_product2_feature2: "High protein for an active lifestyle",
      showcase_product2_feature3: "Retains all essential nutrients",
      showcase_product2_feature4: "Great taste without compromise",
      showcase_product3_title: "Skim Milk Powder",
      showcase_product3_feature1: "Certified best seller",
      showcase_product3_feature2: "Free from hormones, antibiotics, or pesticides",
      showcase_product3_feature3: "Eco-friendly farming",
      showcase_product3_feature4: "Premium quality for discerning tastes",
      showcase_detail_button: "Detail",
      showcase_order_button: "Order Now",

      // Product Cards Section
      cards_title: "Choose Your Favorite Product",
      cards_text: "Click on a product to learn more about its benefits",
      cards_product1_title: "Fat Filled Whey Powder",
      cards_product1_text: "Rich & Creamy",
      cards_product2_title: "Full Cream Milk Powder",
      cards_product2_text: "Healthy Choice",
      cards_product3_title: "Skim Milk Powder",
      cards_product3_text: "Pure & Natural",

      // Product Modal
      modal_product1_title: "Fat Filled Whey Powder",
      modal_product1_description: "A creamy, smooth-textured milk powder at an economical price for your food and beverage applications",
      modal_product1_feature1: "Rich in natural vitamins and minerals",
      modal_product1_feature2: "Suitable for children and adults",
      modal_product1_feature3: "100% natural with no artificial additives",
      modal_product1_feature4: "Guaranteed fresh delivery every day",
      modal_product2_title: "Full Cream Milk Powder",
      modal_product2_description: "100% pure cow's milk with a rich taste and complete nutritional content",
      modal_product2_feature1: "Low fat content for health-conscious families",
      modal_product2_feature2: "High protein for an active lifestyle",
      modal_product2_feature3: "Retains all essential nutrients",
      modal_product2_feature4: "Great taste without compromise",
      modal_product3_title: "Skim Milk Powder",
      modal_product3_description: "Low-fat, high-protein milk powder, ideal for healthy and low-calorie products",
      modal_product3_feature1: "Certified best seller",
      modal_product3_feature2: "Free from hormones, antibiotics, or pesticides",
      modal_product3_feature3: "Eco-friendly farming",
      modal_product3_feature4: "Premium quality for discerning tastes",
      modal_advantage1: "Premium quality – Processed from the finest raw materials",
      modal_advantage2: "Competitive pricing – Maximize margins without compromising taste",
      modal_advantage3: "Safe & reliable – Meets international food safety standards",
      modal_advantage4: "Fast delivery – Supported by logistics for timely distribution",
      modal_application1: "Instant powdered drinks",
      modal_application2: "Ice cream & desserts",
      modal_application3: "Chocolates & candies",
      modal_application4: "Bread, cakes, & biscuits",
      modal_application5: "Low-fat yogurt & cheese",
      modal_products_header: "Product Features",
      modal_advantages_header: "Advantages",
      modal_applications_header: "Applications",
    },
  },
  id: {
    products: {
      // Banner Section
      banner_title: "Produk",
      banner_text: "Jelajahi keajaiban yang telah kami ciptakan",

      // Product Showcase Section
      showcase_product1_title: "Fat Filled Whey Powder",
      showcase_product1_feature1: "Kaya akan vitamin dan mineral alami",
      showcase_product1_feature2: "Cocok untuk anak-anak dan orang dewasa",
      showcase_product1_feature3: "100% alami tanpa bahan tambahan buatan",
      showcase_product1_feature4: "Pengiriman segar setiap hari dijamin",
      showcase_product2_title: "Full Cream Milk Powder",
      showcase_product2_feature1: "Kandungan lemak rendah untuk keluarga yang peduli kesehatan",
      showcase_product2_feature2: "Kandungan protein tinggi untuk gaya hidup aktif",
      showcase_product2_feature3: "Mempertahankan semua nutrisi penting",
      showcase_product2_feature4: "Rasa yang enak tanpa kompromi",
      showcase_product3_title: "Skim Milk Powder",
      showcase_product3_feature1: "Penjualan terbaik bersertifikasi",
      showcase_product3_feature2: "Bebas hormon, antibiotik, atau pestisida",
      showcase_product3_feature3: "Peternakan ramah lingkungan",
      showcase_product3_feature4: "Kualitas premium untuk selera yang istimewa",
      showcase_detail_button: "Detail",
      showcase_order_button: "Pesan Sekarang",

      // Product Cards Section
      cards_title: "Pilih Produk Favorit Anda",
      cards_text: "Klik pada produk untuk mengetahui lebih lanjut tentang manfaatnya",
      cards_product1_title: "Fat Filled Whey Powder",
      cards_product1_text: "Kaya & Lembut",
      cards_product2_title: "Full Cream Milk Powder",
      cards_product2_text: "Pilihan Sehat",
      cards_product3_title: "Skim Milk Powder",
      cards_product3_text: "Murni & Alami",

      // Product Modal
      modal_product1_title: "Fat Filled Whey Powder",
      modal_product1_description: "Rasa creamy, tekstur lembut, dan harga ekonomis untuk aplikasi makanan dan minuman Anda",
      modal_product1_feature1: "Kaya akan vitamin dan mineral alami",
      modal_product1_feature2: "Cocok untuk anak-anak dan orang dewasa",
      modal_product1_feature3: "100% alami tanpa bahan tambahan buatan",
      modal_product1_feature4: "Pengiriman segar setiap hari dijamin",
      modal_product2_title: "Full Cream Milk Powder",
      modal_product2_description: "100% susu sapi murni dengan cita rasa kaya dan kandungan gizi lengkap",
      modal_product2_feature1: "Kandungan lemak rendah untuk keluarga yang peduli kesehatan",
      modal_product2_feature2: "Kandungan protein tinggi untuk gaya hidup aktif",
      modal_product2_feature3: "Mempertahankan semua nutrisi penting",
      modal_product2_feature4: "Rasa yang enak tanpa kompromi",
      modal_product3_title: "Skim Milk Powder",
      modal_product3_description: "Rendah lemak, tinggi protein, cocok untuk produk sehat dan rendah kalori",
      modal_product3_feature1: "Penjualan terbaik bersertifikasi",
      modal_product3_feature2: "Bebas hormon, antibiotik, atau pestisida",
      modal_product3_feature3: "Peternakan ramah lingkungan",
      modal_product3_feature4: "Kualitas premium untuk selera yang istimewa",
      modal_advantage1: "Kualitas Premium – Diproses dari bahan baku terbaik",
      modal_advantage2: "Harga Kompetitif – Maksimalkan margin tanpa kompromi rasa",
      modal_advantage3: "Aman & Terjamin – Sesuai standar keamanan pangan internasional",
      modal_advantage4: "Pengiriman Cepat – Dukungan logistik untuk distribusi tepat waktu",
      modal_application1: "Minuman bubuk instan",
      modal_application2: "Es krim & dessert",
      modal_application3: "Cokelat & permen",
      modal_application4: "Roti, kue, & biskuit",
      modal_application5: "Yogurt & keju rendah lemak",
      modal_products_header: "Fitur Produk",
      modal_advantages_header: "Keunggulan",
      modal_applications_header: "Aplikasi",
    },
  },
};

const productDetails = {
  0: {
    image: "./img/product1_compro_clean.jpg",
    title: "products.modal_product1_title",
    description: "products.modal_product1_description",
    features: [
      "products.modal_product1_feature1",
      "products.modal_product1_feature2",
      "products.modal_product1_feature3",
      "products.modal_product1_feature4",
    ],
  },
  1: {
    image: "./img/product2_compro_clean.jpg",
    title: "products.modal_product2_title",
    description: "products.modal_product2_description",
    features: [
      "products.modal_product2_feature1",
      "products.modal_product2_feature2",
      "products.modal_product2_feature3",
      "products.modal_product2_feature4",
    ],
  },
  2: {
    image: "./img/product3_compro_clean.jpg",
    title: "products.modal_product3_title",
    description: "products.modal_product3_description",
    features: [
      "products.modal_product3_feature1",
      "products.modal_product3_feature2",
      "products.modal_product3_feature3",
      "products.modal_product3_feature4",
    ],
  },
};

const advantages = [
  "products.modal_advantage1",
  "products.modal_advantage2",
  "products.modal_advantage3",
  "products.modal_advantage4",
];

const applications = [
  "products.modal_application1",
  "products.modal_application2",
  "products.modal_application3",
  "products.modal_application4",
  "products.modal_application5",
];

function getCurrentPage() {
  const path = window.location.pathname.split("/");
  const file = path[path.length - 1] || "products.html";
  return file.replace(".html", "");
}

function setLanguage(lang) {
  localStorage.setItem("language", lang);
  updateContent(lang);
}

function updateContent(lang) {
  const translation = translations[lang] || translations["id"];
  const page = getCurrentPage();

  // Select all elements with data-translate attribute
  const elements = document.querySelectorAll("[data-translate]");
  
  elements.forEach((element) => {
    const key = element.getAttribute("data-translate");
    // Access nested translation (e.g., products.banner_title)
    const keys = key.split(".");
    let value = translation;
    
    // Traverse the translation object to get the value
    for (const k of keys) {
      value = value[k];
      if (!value) break;
    }
    
    // Update the element's text content if a valid translation is found
    if (value) {
      element.textContent = value;
    }
  });
}

function showProductModal(productIndex) {
  const product = productDetails[productIndex];
  const currentLang = localStorage.getItem("language") || "id";

  const modalContent = `
    <div class="text-center mb-6">
      <img src="${product.image}" alt="Product Image" class="w-48 h-48 mx-auto rounded-2xl object-cover mb-4 shadow-lg">
      <h2 class="text-3xl font-bold mb-4" style="color: var(--text-dark)" data-translate="${product.title}">
        ${translations[currentLang].products[product.title.split(".")[1]]}
      </h2>
      <p class="text-lg" style="color: var(--text-medium)" data-translate="${product.description}">
        ${translations[currentLang].products[product.description.split(".")[1]]}
      </p>
    </div>
    
    <div class="grid md:grid-cols-3 gap-8">
      <div>
        <h3 class="text-xl font-semibold mb-4 text-center" style="color: var(--accent-gold)" data-translate="products.modal_products_header">
          ${translations[currentLang].products.modal_products_header}
        </h3>
        <ul class="space-y-2">
          ${product.features
            .map(
              (feature) => `
            <li class="flex items-start">
              <i class="fas fa-check-circle mt-1 mr-3" style="color: var(--accent-gold)"></i>
              <span class="text-sm" style="color: var(--text-medium)" data-translate="${feature}">
                ${translations[currentLang].products[feature.split(".")[1]]}
              </span>
            </li>
          `
            )
            .join("")}
        </ul>
      </div>
      
      <div>
        <h3 class="text-xl font-semibold mb-4 text-center" style="color: var(--accent-gold)" data-translate="products.modal_advantages_header">
          ${translations[currentLang].products.modal_advantages_header}
        </h3>
        <ul class="space-y-2">
          ${advantages
            .map(
              (advantage) => `
            <li class="flex items-start">
              <i class="fas fa-medal mt-1 mr-3" style="color: var(--accent-gold)"></i>
              <span class="text-sm" style="color: var(--text-medium)" data-translate="${advantage}">
                ${translations[currentLang].products[advantage.split(".")[1]]}
              </span>
            </li>
          `
            )
            .join("")}
        </ul>
      </div>
      
      <div>
        <h3 class="text-xl font-semibold mb-4 text-center" style="color: var(--accent-gold)" data-translate="products.modal_applications_header">
          ${translations[currentLang].products.modal_applications_header}
        </h3>
        <ul class="space-y-2">
          ${applications
            .map(
              (app) => `
            <li class="flex items-start">
              <i class="fas fa-arrow-right mt-1 mr-3" style="color: var(--accent-gold)"></i>
              <span class="text-sm" style="color: var(--text-medium)" data-translate="${app}">
                ${translations[currentLang].products[app.split(".")[1]]}
              </span>
            </li>
          `
            )
            .join("")}
        </ul>
      </div>
    </div>
  `;

  $("#modalContent").html(modalContent);
  $("#productModal").addClass("show");
  
  // Re-apply translations after modal content is updated
  updateContent(currentLang);
}

// Initialize page and event listeners
document.addEventListener("DOMContentLoaded", () => {
  const savedLang = localStorage.getItem("language") || "id";
  updateContent(savedLang);

  // Attach event listeners for detail buttons and product cards
  $(document).on("click", ".detail-btn, .product-card", function() {
    const productIndex = $(this).data("product");
    showProductModal(productIndex);
    $(".product-showcase").slick("slickGoTo", productIndex);
    updateActiveProduct(productIndex);
  });

  // Close modal
  $(document).on("click", ".close", function() {
    $("#productModal").removeClass("show");
  });

  // Close modal when clicking outside
  $(document).on("click", "#productModal", function(event) {
    if (event.target.id === "productModal") {
      $("#productModal").removeClass("show");
    }
  });

  // Initialize Slick slider
  $(".product-showcase").slick({
    dots: false,
    infinite: true,
    speed: 500,
    fade: true,
    cssEase: "linear",
    autoplay: false,
    arrows: true,
    slidesToShow: 1,
    slidesToScroll: 1,
    responsive: [
      {
        breakpoint: 768,
        settings: {
          arrows: false,
          dots: true,
        },
      },
    ],
  });

  // Update active product card when slider changes
  $(".product-showcase").on("beforeChange", function(event, slick, currentSlide, nextSlide) {
    updateActiveProduct(nextSlide);
  });

  // Set initial active product
  updateActiveProduct(0);

  // Initialize AOS
  AOS.init({
    duration: 800,
    easing: "ease-in-out",
    once: true,
  });
});

// Update active product card with neon glow effect
function updateActiveProduct(index) {
  $(".product-card").removeClass("neon-glow");
  $(`.product-card[data-product="${index}"]`).addClass("neon-glow");
}